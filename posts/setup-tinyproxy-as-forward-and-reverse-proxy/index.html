<!DOCTYPE html>
<html lang="en" class="no-js"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta http-equiv="X-UA-Compatible" content="ie=edge"><link rel="alternate" type="application/rss+xml" title="" href="https://isabelcosta.github.io//feed.xml"><link rel="icon" href="/images/favicon.png" type="image/png"><title>How I set up Tinyproxy as a forward proxy and reverse proxy | Isabel Costa</title><link rel="canonical" href="https://isabelcosta.github.io//posts/setup-tinyproxy-as-forward-and-reverse-proxy/"><meta property="og:site_name" content="Isabel Costa"><meta property="og:title" content="How I set up Tinyproxy as a forward proxy and reverse proxy | Isabel Costa"><meta property="og:type" content="website"><meta property="og:url" content="https://isabelcosta.github.io//posts/setup-tinyproxy-as-forward-and-reverse-proxy/"><meta name="twitter:creator" content="@isabelcmdcosta"><meta name="monetization" content=" "><script>document.documentElement.classList.remove('no-js');</script><style>*{box-sizing:border-box}:after,:before{box-sizing:inherit}body,dd,dl,dt,figcaption,figure,h1,h2,h3,h4,li,ol,p,ul{margin:0;padding:0}body{-ms-overflow-style:-ms-autohiding-scrollbar;scroll-behavior:smooth;font-size:1rem;min-height:100vh}ol[class],ul[class]{list-style:none}a:not([class]){text-decoration:underline;text-decoration-skip-ink:auto;cursor:pointer}input::-webkit-input-placeholder,select::-webkit-input-placeholder,textarea::-webkit-input-placeholder{line-height:normal}img{max-width:100%}@media(prefers-reduced-motion:reduce){*{-webkit-animation:none!important;animation:none!important;transition:none!important;scroll-behavior:auto!important}}.sf-flow{--flow-space:1em}.sf-flow>*+*{margin-top:1em;margin-top:var(--flow-space)}.align-start{align-items:flex-start}.align-center{align-items:center}.align-end{align-items:flex-end}.bg-primary{background:#173854}.bg-primary-shade{background:#102538}.bg-primary-glare{background:#22547c}.bg-highlight{background:#a7dcfa}.bg-light{background:#fff}.bg-mid{background:#ccc}.bg-dark{background:#333}.bg-slate{background:#404040}.color-primary{color:#173854}.color-primary-shade{color:#102538}.color-primary-glare{color:#22547c}.color-highlight{color:#a7dcfa}.color-light{color:#fff}.color-mid{color:#ccc}.color-dark{color:#333}.color-slate{color:#404040}.box-block{display:block}.box-flex{display:flex}.box-inline-flex{display:inline-flex}.box-hide{display:none}.font-base{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol'}.font-serif{font-family:Lora,serif}.gap-top-300{margin-top:.8rem}.gap-top-500{margin-top:1.25rem}.gap-top-600{margin-top:1.56rem}.gap-top-700{margin-top:1.95rem}.gap-top-800{margin-top:2.44rem}.gap-top-900{margin-top:3.05rem}.gap-top-base{margin-top:1rem}.gap-top-max{margin-top:4rem}.gap-bottom-300{margin-bottom:.8rem}.gap-bottom-500{margin-bottom:1.25rem}.gap-bottom-600{margin-bottom:1.56rem}.gap-bottom-700{margin-bottom:1.95rem}.gap-bottom-800{margin-bottom:2.44rem}.gap-bottom-900{margin-bottom:3.05rem}.gap-bottom-base{margin-bottom:1rem}.gap-bottom-max{margin-bottom:4rem}.leading-tight{line-height:1.2}.leading-mid{line-height:1.5}.leading-loose{line-height:1.7}.measure-long{max-width:75ch}.measure-short{max-width:60ch}.measure-compact{max-width:40ch}.pad-top-300{padding-top:.8rem}.pad-top-500{padding-top:1.25rem}.pad-top-600{padding-top:1.56rem}.pad-top-700{padding-top:1.95rem}.pad-top-800{padding-top:2.44rem}.pad-top-900{padding-top:3.05rem}.pad-top-base{padding-top:1rem}.pad-top-max{padding-top:4rem}.pad-bottom-300{padding-bottom:.8rem}.pad-bottom-500{padding-bottom:1.25rem}.pad-bottom-600{padding-bottom:1.56rem}.pad-bottom-700{padding-bottom:1.95rem}.pad-bottom-800{padding-bottom:2.44rem}.pad-bottom-900{padding-bottom:3.05rem}.pad-bottom-base{padding-bottom:1rem}.pad-bottom-max{padding-bottom:4rem}.pad-left-300{padding-left:.8rem}.pad-left-500{padding-left:1.25rem}.pad-left-600{padding-left:1.56rem}.pad-left-700{padding-left:1.95rem}.pad-left-800{padding-left:2.44rem}.pad-left-900{padding-left:3.05rem}.pad-left-base{padding-left:1rem}.pad-left-max{padding-left:4rem}.space-between{justify-content:space-between}.space-around{justify-content:space-around}.space-before{justify-content:flex-end}.stack-300{z-index:0}.stack-400{z-index:10}.stack-500{z-index:20}.stack-600{z-index:30}.stack-700{z-index:40}.ta-right{text-align:right}.ta-left{text-align:left}.ta-center{text-align:center}.text-300{font-size:.8rem}.text-500{font-size:1.25rem}.text-600{font-size:1.56rem}.text-700{font-size:1.95rem}.text-800{font-size:2.44rem}.text-900{font-size:3.05rem}.text-base{font-size:1rem}.text-max{font-size:4rem}.weight-light{font-weight:300}.weight-regular{font-weight:400}.weight-mid{font-weight:600}.weight-bold{font-weight:700}.width-full{width:100%}.width-half{width:50%}.width-quarter{width:25%}.width-third{width:33.3333333333%}@media screen and (min-width:48rem){.md\:align-start{align-items:flex-start}.md\:align-center{align-items:center}.md\:align-end{align-items:flex-end}.md\:box-block{display:block}.md\:box-flex{display:flex}.md\:box-inline-flex{display:inline-flex}.md\:box-hide{display:none}.md\:space-between{justify-content:space-between}.md\:space-around{justify-content:space-around}.md\:space-before{justify-content:flex-end}.md\:ta-right{text-align:right}.md\:ta-left{text-align:left}.md\:ta-center{text-align:center}.md\:text-300{font-size:.8rem}.md\:text-500{font-size:1.25rem}.md\:text-600{font-size:1.56rem}.md\:text-700{font-size:1.95rem}.md\:text-800{font-size:2.44rem}.md\:text-900{font-size:3.05rem}.md\:text-base{font-size:1rem}.md\:text-max{font-size:4rem}.md\:width-full{width:100%}.md\:width-half{width:50%}.md\:width-quarter{width:25%}.md\:width-third{width:33.3333333333%}}:root{--color-primary:#173854;--color-primary-shade:#102538;--color-primary-glare:#22547c;--color-highlight:#a7dcfa;--color-light:#ffffff;--color-mid:#cccccc;--color-dark:#333333;--color-slate:#404040;--color-mode:"light";--color-bg:#ffffff;--color-bg-glare:#ffffff;--color-text:#333333;--color-text-glare:#333333;--color-selection-text:#ffffff;--color-selection-bg:#333333;--color-stroke:#cccccc;--color-action-bg:#173854;--color-action-text:#ffffff;--color-theme-primary:#173854;--color-theme-primary-glare:#22547c;--color-theme-highlight:#a7dcfa;--color-theme-highlight-block:#a7dcfa}@media(prefers-color-scheme:dark){:root{--color-mode:"dark"}:root:not([data-user-color-scheme]){--color-bg:#333333;--color-bg-glare:#404040;--color-text:#ffffff;--color-selection-text:#333333;--color-selection-bg:#ffffff;--color-stroke:#404040;--color-theme-primary:#8bb8df;--color-theme-primary-glare:#b3d2ea;--color-action-bg:var(--color-theme-primary-glare);--color-action-text:#333333;--color-theme-highlight:#a7dcfa;--color-theme-highlight-block:#404040;--color-theme-feature-text:#a7dcfa}}[data-user-color-scheme=dark]{--color-bg:#333333;--color-bg-glare:#404040;--color-text:#ffffff;--color-selection-text:#333333;--color-selection-bg:#ffffff;--color-stroke:#404040;--color-theme-primary:#8bb8df;--color-theme-primary-glare:#b3d2ea;--color-action-bg:var(--color-theme-primary-glare);--color-action-text:#333333;--color-theme-highlight:#a7dcfa;--color-theme-highlight-block:#404040;--color-theme-feature-text:#a7dcfa}body{color:var(--color-text);background-color:var(--color-bg)}main{overflow:hidden}::selection{color:var(--color-selection-text);background-color:var(--color-selection-bg)}@font-face{font-family:Lora;font-style:normal;font-weight:700;font-display:swap;src:local("Lora Bold"),local("Lora-Bold"),url(/fonts/lora-v13-latin-700.woff) format("woff")}body{line-height:1.56;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol'}h1,h2,h3{font-family:Lora,serif}h1{font-size:1.95rem}h2{font-size:1.56rem}h3{font-size:1.25rem}@media(min-width:48rem){h1{font-size:3.05rem}h2{font-size:2.44rem}h3{font-size:1.95rem}}body,html{height:100%}body{scroll-behavior:smooth;display:flex;flex-direction:column}main{flex:1 0 auto}main:focus{outline:0}hr{display:block;height:1px;max-width:500px;background:var(--color-stroke);border:none;margin:3.05rem auto}img{height:auto}:focus{outline:1px solid var(--color-theme-primary-glare);outline-offset:.25rem}.inner-wrapper{max-width:52rem;margin-left:auto;margin-right:auto;padding-left:1.25rem;padding-right:1.25rem}.post__footer h2 a,.skip-link:not(:focus),.visually-hidden{border:0;clip:rect(0 0 0 0);height:auto;margin:0;overflow:hidden;padding:0;position:absolute;width:1px;white-space:nowrap}.wrapper{max-width:58rem;margin-left:auto;margin-right:auto;padding-left:1.25rem;padding-right:1.25rem}.button{display:inline-block;border:none;background-color:var(--color-action-bg);color:var(--color-action-text);padding:.8rem 1rem;line-height:1;margin:0;text-decoration:none;cursor:pointer;-webkit-appearance:none;-moz-appearance:none}.button:focus,.button:hover{filter:brightness(1.2)}.button:focus:hover{outline:0}.button:focus:not(:hover){outline:1px solid var(--color-action-text);outline-offset:-4px}.button:active{transform:scale(.99)}form{max-width:35rem}form br{display:none}label{display:block;font-weight:600}input,select{line-height:1}input,select,textarea{background-color:#fff;font:inherit;border:1px solid var(--color-text);margin-top:.15rem;padding:.5rem 1rem;width:100%;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji','Segoe UI Symbol'}label input{margin:-.25rem .5rem 0 0;width:auto;vertical-align:middle}fieldset{border:0;margin:0;padding:0}legend{display:block;font-weight:700}.field-list{margin:0;padding:0;list-style:none}.field-list__field-group{margin-bottom:2rem;transition:transform 150ms}.field-list__field-group__description{display:block;margin-top:.3rem;font-size:.875rem;line-height:1.25}textarea+.field-list__field-group__description{margin-top:0}.field-list__field-group--confirm{font-weight:400}.field-list__field-group__list{list-style:none;margin:0}.field-list__field-group__list label{font-weight:400}.field-list__field-group__list .field-list__field-group__description{margin:0 0 0 1.35rem}.heading-permalink{color:var(--color-theme-primary-glare);font-size:.8em;margin-left:.3em;margin-top:.2em}@media(min-width:48rem){.heading-permalink{font-size:.6em;margin-top:.4em}}.intro{background:var(--color-theme-highlight-block)}.intro__summary{--flow-space:1.25rem;font-size:1.25rem}.intro__summary a{color:currentColor}.intro__summary a:hover{text-decoration:none}.intro__heading{max-width:40ex;color:var(--color-theme-feature-text)}.intro__heading--compact{max-width:20ex}.nav__list{overflow-x:auto;padding:.5rem;margin:-.5rem;-webkit-overflow-scrolling:touch;-ms-overflow-style:none}.nav__list::-webkit-scrollbar{display:none}.nav__list>*+*{margin-left:1.25rem}.nav__item{padding:.8rem 0;flex-shrink:0}.nav__item a{color:currentColor;font-weight:600}.nav__item a:not(:hover){text-decoration:none}.pagination{flex-wrap:wrap}.pagination a{color:var(--color-theme-primary)}.pagination a:not(:hover){text-decoration:none}.pagination a[data-direction=backwards]{flex-direction:row-reverse}.pagination a[data-direction=backwards] svg{transform:rotate(-180deg)}.pagination a[data-direction=forwards]:only-child{margin-left:auto}.pagination svg{pointer-events:none}.post__body{--flow-space:2.44rem}.post__body h2+*,.post__body h3+*{--flow-space:1.25rem}.post__body h2,.post__body h3{position:relative;line-height:1.2}.post__body a{color:currentColor}.post__body a:hover{text-decoration:none}.post__body a:not([class]):hover{text-decoration:underline}.post__body code{font-size:1.2em;color:var(--color-theme-primary);font-weight:600;margin-left:.01ch;margin-right:.01ch}.post__body pre>code{margin-right:0;border:1px solid rgba(255,255,255,.1);overflow-x:auto;-webkit-overflow-scrolling:touch;color:var(--color-mid)}.post__body blockquote{border-left:.4rem solid var(--color-theme-primary-glare);margin-left:0;padding-left:1.25rem;font-style:italic;font-size:1.56rem}.post__body blockquote p{opacity:.85;padding:1.25rem 0}.post__body ol:not([class]),.post__body ul:not([class]){margin-left:2.44rem}.post__body ol:not([class]) li+li,.post__body ul:not([class]) li+li{margin-top:.8rem}.post__body .video-player,.post__body .video-player+*,.post__body figure,.post__body figure+*,.post__body pre>code,.post__body video{--flow-space:4rem}.post__body .video-player,.post__body figure,.post__body pre>code,.post__body video{width:100vw;max-width:58rem;margin-left:50%;transform:translateX(-50%);position:relative}.post__body .video-player,.post__body figure img,.post__body pre>code{box-shadow:0 10px 30px rgba(0,0,0,.15)}.post__body figure img{position:relative;z-index:1}.post__body figcaption{font-size:.8em;font-style:italic;max-width:52rem;margin:.5rem auto 0 auto;padding:0 1.25rem}.post__body pre>code{display:block;background:var(--color-dark);padding:1.95rem;font-size:1.25rem}.post__footer{background:var(--color-theme-highlight)}.post__footer h2{flex-shrink:0;margin-right:1rem;color:var(--color-dark)}.post__footer a{background:var(--color-bg);padding:.4rem .6rem}.post-list__item{--flow-space:1.95rem}.post-list__link,.post-list__link:visited{color:var(--color-theme-primary);text-decoration:none}.post-list__link:hover{text-decoration:underline}.post-list__tag{color:var(--color-dark);position:relative;display:inline-block;background:var(--color-theme-highlight);padding:.2rem .4rem .3rem .4rem;text-decoration:none;word-break:break-word;margin:.4rem .4rem;line-height:1.2;font-weight:600}.site-head__site-name{font-weight:700;text-decoration:none;color:var(--color-text)}.site-foot{background:var(--color-bg-glare);color:var(--color-text);border-top:1px solid var(--color-stroke)}.site-foot a{color:currentColor}.site-foot a:hover{text-decoration:none}.site-foot__credit{text-align:center}.skip-link:focus{display:inline-block;position:absolute;top:0;left:0;padding:.8rem 1.25rem 1rem 1.25rem;background-color:var(--color-action-bg);color:var(--color-action-text);line-height:1;text-decoration:none;font-weight:700}code[class*=language-],pre[class*=language-]{color:#f8f8f2;background:0 0;font-family:Consolas,Monaco,"Andale Mono","Ubuntu Mono",monospace;text-align:left;word-spacing:normal;word-break:normal;word-wrap:normal;-moz-tab-size:2;-o-tab-size:2;tab-size:2;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal}.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#d4d0ab}.token.punctuation{color:#fefefe}.token.constant,.token.deleted,.token.property,.token.symbol,.token.tag{color:#ffa07a}.token.boolean,.token.number{color:#00e0e0}.token.attr-name,.token.builtin,.token.char,.token.inserted,.token.selector,.token.string{color:#abe338}.language-css .token.string,.style .token.string,.token.entity,.token.operator,.token.url,.token.variable{color:#00e0e0}.token.atrule,.token.attr-value,.token.function{color:gold}.token.keyword{color:#00e0e0}.token.important,.token.regex{color:gold}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}@media screen and (-ms-high-contrast:active){code[class*=language-],pre[class*=language-]{color:windowText;background:window}:not(pre)>code[class*=language-],pre[class*=language-]{background:window}.token.important{background:highlight;color:window;font-weight:400}.token.atrule,.token.attr-value,.token.function,.token.keyword,.token.operator,.token.selector{font-weight:700}.token.attr-value,.token.comment,.token.doctype,.token.function,.token.keyword,.token.operator,.token.property,.token.string{color:highlight}.token.attr-value,.token.url{font-weight:400}}.video-player{position:relative;padding-top:56.25%}.video-player>iframe{position:absolute;top:0;left:0;width:100%;height:100%}.post .video-player{padding-top:63%}@media(min-width:48rem){.post .video-player{padding-top:66%}}</style></head><body><a class="skip-link" href="#main-content">Skip to content</a><header role="banner" class="[ site-head ] [ pad-top-700 pad-bottom-700"><div class="wrapper"><div class="[ site-head__inner ] [ md:box-flex space-between align-center ]"><a href="/" class="[ site-head__site-name ] [ leading-tight ]"><span class="visually-hidden">Isabel Costa - Home</span> <span class="[ site-head__site-name ] [ text-600 ]" aria-hidden="true">Isabel Costa</span></a><nav class="nav" aria-label="navigation"><ul class="[ nav__list ] [ box-flex align-center md:space-before ]"><li class="nav__item"><a href="/">~</a></li><li class="nav__item"><a href="/about">~/about</a></li><li class="nav__item"><a href="/posts">~/posts</a></li><li class="nav__item"><a href="/talks">~/talks</a></li><li class="nav__item"><a href="/work">~/work</a></li></ul></nav></div></div></header><main id="main-content" tabindex="-1"><article class="[ post ] [ h-entry ]"><header class="[ intro ] [ pad-top-900 pad-bottom-max ]"><div class="[ inner-wrapper ] [ sf-flow ]"><h1 class="[ intro__heading ] [ text-800 md:text-900 leading-tight ] [ p-name ]">How I set up Tinyproxy as a forward proxy and reverse proxy</h1><div class="[ intro__summary ] [ sf-flow ] [ leading-mid measure-short ]"><p class="[ intro__meta ] [ text-500 leading-tight ]"><time datetime="2018-09-06T00:00:00.000Z" class="dt-published">6 Sep 2018</time> <span>‚Äî 6 minute read</span></p></div></div></header><div class="[ post__body ] [ inner-wrapper ] [ leading-loose pad-top-900 pad-bottom-900 text-500 ] [ sf-flow ] [ e-content ]"><p><a href="https://tinyproxy.github.io/">Tinyproxy</a> is a light-weight HTTP/HTTPS proxy daemon for POSIX operating systems, which is <a href="https://github.com/tinyproxy/tinyproxy">open source on Github</a>.</p><p>I tried out this tool to set up a <a href="https://en.wikipedia.org/wiki/Proxy_server">forward proxy</a> on the client side of the communication and a <a href="https://en.wikipedia.org/wiki/Reverse_proxy">reverse proxy</a> on the server side. I wanted to use this so that I could do experiments on the network between the forward proxy and reverse proxy, without the client and server‚Äôs involvement.</p><p>Reverse proxies are mostly used as a load balancer, where we connect with a reverse proxy which then decides to which machine it should send the request.</p><blockquote><p>‚Äú(‚Ä¶) With reverse proxying it‚Äôs possible to make a number of sites appear as if they were part of a single site (‚Ä¶)‚Äù</p></blockquote><p>from the manual of the configuration file of Tinyproxy.</p><h2 id="heading-requirements">Requirements<a href="#heading-requirements" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p>The following requirements represent what I used in my experiment:</p><ul><li>An image with a Linux OS distribution ‚Äî I used a <a href="https://www.debian.org/">Debian</a> GNU/Linux 8.9 (Jessie);</li><li>4 virtual machines to serve as client, forward proxy, reverse proxy and server ‚Äî I used <a href="https://www.virtualbox.org/">VirtualBox</a> to run these machines, with the Debian‚Äôs OS image;</li><li>The server has to run a Web Server ‚Äî I used <a href="https://httpd.apache.org/">Apache HTTP server</a>, to return the default HTML page saying ‚ÄúIt works!‚Äù;</li><li>The client has to have a browser or a command-line tool installed such as <a href="https://curl.haxx.se/">curl</a>, to do HTTP requests;</li><li>The forward and reverse proxy machines should have <a href="https://tinyproxy.github.io/">tinyproxy</a> installed ‚Äî Next I‚Äôll show how to install it on the Debian machines. The version I used was 1.8.3.</li></ul><h2 id="heading-test-architecture">Test architecture<a href="#heading-test-architecture" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p><img src="/images/tinyproxy-trial-architecture.png" alt="Test architecture for the experiment" loading="lazy" width="1127" height="225"></p><p>I created <a href="https://github.com/isabelcosta/testing-tiny-proxy">isabelcosta/testing-tiny-proxy</a> repository on Github with the configuration files needed to run both roles of forward proxy and reverse proxy.</p><h2 id="heading-network-configuration">Network Configuration<a href="#heading-network-configuration" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p>VirtualBox lets you configure the network settings of the virtual machines. I used Nat Network setting which allowed me to have all the machines within the same network. These were the IP assigned to each machine.</p><ul><li>Client ‚Äî 10.0.2.33</li><li>Forward Proxy ‚Äî 10.0.2.35</li><li>Reverse Proxy ‚Äî 10.0.2.36</li><li>Server ‚Äî 10.0.2.34</li></ul><p>These IP addresses will be important, because they will appear in the examples of how to test the system.</p><h2 id="heading-install-tinyproxy">Install Tinyproxy<a href="#heading-install-tinyproxy" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p>To install Tinyproxy, you have to type the following command into the forward and reverse proxy machines‚Äôs terminal:</p><pre><code>apt-get install tinyproxy
</code></pre><h2 id="heading-setting-up-the-system">Setting up the system<a href="#heading-setting-up-the-system" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p>Tinyproxy works according to configuration files. I wrote two configurations, one for the forward proxy and another for the reverse proxy.</p><p><strong>Forward proxy configuration files:</strong></p><pre><code>## forwardproxy.conf -- tinyproxy daemon configuration file

User nobody
Group nogroup

Port 8888
Listen 10.0.2.35
BindSame yes

Timeout 600

DefaultErrorFile "/usr/share/tinyproxy/default.html"
StatFile "/usr/share/tinyproxy/stats.html"
Logfile "/var/log/tinyproxy/tinyproxy.log"
#Syslog On
LogLevel Info
PidFile "/var/run/tinyproxy/tinyproxy.pid"

# Comment to use only the forward proxy
# Uncomment to forward the traffic to the reverse proxy
#Upstream 10.0.2.36:8888

MaxClients 100
MinSpareServers 2
MaxSpareServers 5
StartServers 2
MaxRequestsPerChild 0

Allow 127.0.0.1
Allow 10.0.2.0/24

ViaProxyName "tinyproxy1"

ConnectPort 8888
ConnectPort 80

# The following two ports are used by SSL.
ConnectPort 443
ConnectPort 563
</code></pre><p><strong>Reverse proxy configuration files:</strong></p><pre><code>## reverseproxy.conf -- tinyproxy daemon configuration file

User nobody
Group nogroup

Port 8888
Listen 10.0.2.36

BindSame yes
Timeout 600

StatFile "/usr/share/tinyproxy/stats.html"
Logfile "/var/log/tinyproxy/tinyproxy.log"
#Syslog On
LogLevel Info
PidFile "/var/run/tinyproxy/tinyproxy.pid"

MaxClients 5
MinSpareServers 2
MaxSpareServers 5
StartServers 2

MaxRequestsPerChild 0

Allow 127.0.0.1
Allow 10.0.2.0/24
Allow 10.0.2.35

ViaProxyName "tinyproxy2"

ConnectPort 8888
ConnectPort 80

# The following two ports are used by SSL.
ConnectPort 443
ConnectPort 563

ReversePath "/test/" "http://10.0.2.34:80/"
#ReversePath "/" "http://10.0.2.34:80/"
ReversePath "/wired/" "http://www.wired.com/"

ReverseOnly Yes
ReverseMagic Yes
ReverseBaseURL "http://10.0.2.36:8888/"
</code></pre><p>To run tinyproxy with a specific configuration just do the following:</p><pre><code>tinyproxy -c &lt;configuration-file&gt;
</code></pre><p>E.g.: tinyproxy -c forwardproxy.conf</p><h2 id="heading-testing-the-system">Testing the system<a href="#heading-testing-the-system" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><p>First make sure that the server is running accordingly and you can access the server with the following command, from any of the machines, since all of them are in the same network. You can test this using <a href="https://curl.haxx.se/">curl</a> command line tool or on a browser:</p><pre><code>curl http://10.0.2.34:80/ 
</code></pre><p>Now to test the whole system, if you want to use curl you can type this on the client machine console:</p><pre><code>curl -v --proxy http://10.0.2.35:8888 http://10.0.2.36:8888/
</code></pre><p>This is the output of the previous command:</p><pre><code>root@debian:/home/debian# curl -v --proxy http://10.0.2.35:8888 http://10.0.2.36:8888
* Rebuilt URL to: http://10.0.2.36:8888/
* Hostname was NOT found in DNS cache
*   Trying 10.0.2.35...
* Connected to 10.0.2.35 (10.0.2.35) port 8888 (#0)
&gt; GET http://10.0.2.36:8888/ HTTP/1.1
&gt; User-Agent: curl/7.38.0
&gt; Host: 10.0.2.36:8888
&gt; Accept: */*
&gt; Proxy-Connection: Keep-Alive
&gt; 
&lt; HTTP/1.1 200 OK
&lt; Via: 1.0 tinyproxy2 (tinyproxy/1.8.3), 1.1 tinyproxy1 (tinyproxy/1.8.3)
&lt; Last-Modified: Mon, 11 Jun 2007 18:53:14 GMT
&lt; Date: Tue, 12 Dec 2017 23:01:37 GMT
&lt; Content-Type: text/html
&lt; ETag: "2d-432a5e4a73a80"
&lt; Set-Cookie: yummy_magical_cookie=/; path=/
* Server Apache/2.4.29 (Unix) is not blacklisted
&lt; Server: Apache/2.4.29 (Unix)
&lt; Content-Length: 45
&lt; Accept-Ranges: bytes
&lt; 
&lt;html&gt;&lt;body&gt;&lt;h1&gt;It works!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;
* Connection #0 to host 10.0.2.35 left intact
</code></pre><p>Another way to see that this is working, is by using <a href="https://www.wireshark.org/">Wireshark</a> tool. This tool allows you to see network traffic. Before testing the system start running Wireshark. By testing in a local network you can see the whole traffic from the client to the server. After requesting and receiving the response from the server, if you filter the Wireshark captures by ‚Äúhttp‚Äù, you should see a result similar to the following image.</p><p><img src="/images/tinyproxy-trial-wireshark.png" alt="Wireshark capture of the communication between the client and the server, passing through the proxies." loading="lazy" width="1134" height="205"></p><p>In this <a href="https://www.wireshark.org/">Wireshark</a> capture you can see the traffic in both directions: client ‚Üî forward proxy ‚Üî reverse proxy ‚Üî server.</p><p>To check log file and the forward and reverse proxies, you can type the following on either the machines:</p><pre><code>cat /var/log/tinyproxy/tinyproxy.log
</code></pre><p>If you want to test this in another way you can change the proxies‚Äô configuration files on <a href="https://github.com/isabelcosta/testing-tiny-proxy">isabelcosta/testing-tiny-proxy</a> repository.</p><h2 id="heading-tips-and-notes">Tips &amp; Notes<a href="#heading-tips-and-notes" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><ul><li>If you want to set up other paths you can do it with the ‚ÄúReversePath‚Äù keyword. E.g.: ReversePath ‚Äú/test‚Äù ‚Äúhttp://10.0.2.34:80/‚Äù ‚Äî in this way you can access the server by typing ‚Äúhttp://10.0.2.36:8888/test‚Äù</li><li>I was always getting the error 400 Bad Request, because I was using this tool in the wrong way. I was using curl to connect with the server as the endpoint instead of the reverse proxy. The reverse proxy does not work as a forward proxy, so don‚Äôt use the ‚Äúupstream‚Äù keyword to forward the traffic to the reverse proxy.</li></ul></div><footer class="[ post__footer ] [ pad-top-500 pad-bottom-500 ]"><div class="inner-wrapper"><div class="[ nav ] [ box-flex align-center ]"><h2 class="font-base text-600 weight-mid" id="heading-filed-under">Filed under<a href="#heading-filed-under" class="heading-permalink"><span class="visually-hidden"> permalink</span><svg fill="currentColor" aria-hidden="true" focusable="false" width="1em" height="1em" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.199 13.599a5.99 5.99 0 0 0 3.949 2.345 5.987 5.987 0 0 0 5.105-1.702l2.995-2.994a5.992 5.992 0 0 0 1.695-4.285 5.976 5.976 0 0 0-1.831-4.211 5.99 5.99 0 0 0-6.431-1.242 6.003 6.003 0 0 0-1.905 1.24l-1.731 1.721a.999.999 0 1 0 1.41 1.418l1.709-1.699a3.985 3.985 0 0 1 2.761-1.123 3.975 3.975 0 0 1 2.799 1.122 3.997 3.997 0 0 1 .111 5.644l-3.005 3.006a3.982 3.982 0 0 1-3.395 1.126 3.987 3.987 0 0 1-2.632-1.563A1 1 0 0 0 9.201 13.6zm5.602-3.198a5.99 5.99 0 0 0-3.949-2.345 5.987 5.987 0 0 0-5.105 1.702l-2.995 2.994a5.992 5.992 0 0 0-1.695 4.285 5.976 5.976 0 0 0 1.831 4.211 5.99 5.99 0 0 0 6.431 1.242 6.003 6.003 0 0 0 1.905-1.24l1.723-1.723a.999.999 0 1 0-1.414-1.414L9.836 19.81a3.985 3.985 0 0 1-2.761 1.123 3.975 3.975 0 0 1-2.799-1.122 3.997 3.997 0 0 1-.111-5.644l3.005-3.006a3.982 3.982 0 0 1 3.395-1.126 3.987 3.987 0 0 1 2.632 1.563 1 1 0 0 0 1.602-1.198z"></path></svg></a></h2><ul class="[ nav__list ] [ box-flex align-center pad-left-400 ] [ p-category ]"><li class="nav__item"><a href="/tags/tech">tech</a></li></ul></div></div></footer></article></main><footer role="contentinfo" class="[ site-foot ] [ pad-top-700 pad-bottom-900 ]"><div class="wrapper"><div class="[ site-foot__inner ] [ md:box-flex space-between align-start ]"><div><article class="[ site-foot__details ] [ sf-flow measure-compact ]"><h2 class="font-base text-600">Isabel Costa</h2><p>Isabel Costa is a software engineer from Portugal, who really likes Open Source, Freecell, Clash of Clans, and much more.</p><p><a href="https://github.com/isabelcosta">GitHub</a> | <a href="https://www.linkedin.com/in/isabelcmdcosta">LinkedIn</a> | <a href="https://twitter.com/isabelcmdcosta">Twitter</a> | <a href="https://medium.com/@isabelcmdcosta">Medium</a> | <a href="https://dev.to/isabelcmdcosta">DEV</a></p></article></div><div><nav class="nav" aria-label="footer navigation"><ul class="[ nav__list ] [ box-flex align-center md:space-before ]"><li class="nav__item"><a href="/">~</a></li><li class="nav__item"><a href="/about">~/about</a></li><li class="nav__item"><a href="/posts">~/posts</a></li><li class="nav__item"><a href="/talks">~/talks</a></li><li class="nav__item"><a href="/work">~/work</a></li></ul></nav><theme-toggle></theme-toggle></div></div><p class="[ site-foot__credit ] [ pad-top-900 ]">üë©üèæ‚Äçüíª Source code on GitHub at <a href="https://github.com/isabelcosta/isabelcosta.github.io" rel="external">isabelcosta/isabelcosta.github.io</a>. Powered by the <a href="https://hylia.website" rel="external">Hylia Eleventy Starter Kit v0.7.0</a>.</p></div></footer><script type="module" src="/js/components/theme-toggle.js" async="" defer="defer"></script><script>if ('serviceWorker' in navigator) {
      window.addEventListener('load', () => {
        navigator.serviceWorker.register('/service-worker.js');
      });
    }</script><script src="https://identity.netlify.com/v1/netlify-identity-widget.js" defer="defer"></script></body></html>